\documentclass[10pt]{article}

\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{fullpage}
\usepackage{graphicx}
\usepackage{multicol}

\usepackage{lmodern}
%\renewcommand*\familydefault{\sfdefault}
\newcommand{\lm}{\fontfamily{\sfdefault}\selectfont}
\newcommand{\mb}{\mathbf}
\newcommand{\tmpsection}[1]{}
\let\tmpsection=\section
\renewcommand{\section}[1]{\tmpsection{\lm #1}}

\title{\huge \bfseries \lm Control of Underactuated Vehicular Traffic}
\author{Stanislav Nikolov}

\begin{document}
\maketitle

\begin{multicols}{2}

% Misc stuff to talk about
% Traffic can actually smooth out by itself depending on the parameter governing the dynamics. Can show this analytically for linear dynamics, and demonstrate it for nonlinear dynamics.

% describe / motivate your system
\section{Introduction}
A recent study by the U.S. Treasury Department found that traffic in the United States wasted 1.9 billion gallons of gas. Other studies have suggested that peoplein the United States spent as many as 5 billion hours in traffic, resulting in as much as \$100 billion in lost productivity.  spend and 5 billion hours of productivity in the past year.

Traffic jams form for a variety of reasons. Disturbances, such as traffic accidents, or road bottlenecks cause vehicles to slow down, causing the vehicles behind them to slow down and eventually leading to a wave of traffic traveling upstream of the disturbance. However, traffic jams are often observed to form spontaneously without any apparent disturbance. Even if all vehicles have the same velocity and headway (distance to the car in front), this configuration is not always stable. Under certain conditions, small disturbances amplify and lead to a self-sustaining traffic jam.

The theory of traffic jams has attracted a broad community of researchers and a diverse set of modeling approaches, including fluid models \cite{}, cellular automata models \cite{}, and car-following models \cite{}. Here, we focus on car-following models and the vehicle dynamics that have been proposed to reproduce self-sustaining traffic jams. Bando et al. \cite{Bando} propose the optimal velocity model (OVM) and study the local linear stability about the uniform flow steady state. However, they do not study the region of attraction around the fixed point. Peng et al. \cite{Peng} present a linear traffic model in which each vehicle regulates its headway using proportional-derivative control. Despite its ease of analysis and usefulness as a tool to study linearized dynamics, the linear model alone does not prevent negative velocities or vehicle collisions, nor does it robustly generate self-sustaining traffic jams.\footnote{The system would need modes with purely imaginary eigenvalues.}

In addition to models of the passive vehicle system, many have proposed control policies to smooth out traffic jams. Konishi et al. \cite{Konishi} studied the stability of a controlled OVM. Konishi's system is {\em fully-actuated} since one has control authority over each car. As robotic cars (such as Google's self-driving car \cite{Thrun}) being to join regular cars on the road, a more realistic scenario would be one in which the system is {\em underactuated}. In an underactuated vehicle system, one can only control a subset of {\em active} cars while the rest of the cars ({\em passive} cars) follow a given dynamics. In this work, I propose a simple control policy that stabilizes an otherwise unstable system by controlling only a subset of the cars. In another fully-actuated approach to control, Lenz et al. \cite{} consider the stabilizing effect of an OV function that takes into account multiple headways. This model also admits an underactuated version. % AND YOU'VE IMPLEMENTED IT?

\section{Car Following Model}
In order to talk about stabilizing vehicular traffic, we first present an idealized model of traffic flow. We model traffic as $n$ vehicles driving counterclockwise on a single lane circular road. A ciruclar road may be thought of as an idealization of a ring road that encircles a city. Suppose we have $N$ cars with positions $x_i$ and velocities $v_i$, where car $i-1$ precedes car $i$. Let us call the headway (the free space in front) of the $i$th car $\Delta x_i$.

To model vehicle motion, we must model how each driver would safely react to a given headway. Bando et al \cite{Bando} outline two popular models for safe driving --- the optimal distance model and the optimal velocity model. In the optimal distance model, the driver tries to regulate the headway to a desired value. In the optimal velocity model, the drive tries to maintain an optimal velocity computed from the headway. Here, we will consider the latter model, which gives the following equations of motion:
\begin{align*}
\dot{x}_i &= v_i\\
\dot{v}_i &= a\left(V(\Delta x_i) - v_i\right)
\end{align*}
where $a$ is the driver sensitivity and $V$ is the optimal velocity function. A common choice for $V$ \cite{Bando} is
\begin{align*}
V(\Delta x)=\tanh(\Delta x - 2) + \tanh(2)
\end{align*}

% describe the algorithmic approach you selected and why
\section{Algorithmic Approach}

LQR cost doesn't really handle rewarding high velocity (though it can specify an arbitrarily high desired velocity). SGD can do any objective function.

LQR doesn't know about the constraint that all inter-car distances have to sum to the circumference. Hence, we have to remove the Nth spacing and its derivatives from the state in order to manually enforce the constraint.


\section{Results}

\subsection{Circular Topology}

\paragraph{No delay} Traffic eventually smooths out by itself but it takes a very long time. Adding active cars dramatically reduces the time it takes to smooth out traffic. 

Using LQR: Because the LQR objective prescribes a desired distance between cars, and cars will naturally want to spread out evenly over the whole circle, the active cars end up picking up the ``slack'' in order to make all the distances add up to the circumference of the circle. (This is not the whole story. When the circumference is less than the total sum of the desired spacings, LQR optimizes for cars having the same velocity and takes a penalty on desired distances.)

An interesting observation is that with a small number of active cars, this act of picking up slack can make the distances in front of the active cars oscillate, leading to negative distances. As more active cars are added, each individual car is less burdened with making the distances sum to the cirucmference, and no distances ever become negative.

The passive system only stable for certain gains (how do you know which ones? Make a distinction between stability=smoothness and stability=things not blowing up. That is, self-sustaining traffic is stable in a mathematical sense, but velocities blowing up is not). However, the addition of active cars stabilizes systems that would have otherwise been unstable.

\paragraph{Delay}

Delay appears to make the system take even more time to smooth out (does it? you changed the timestep --- watch out!). However, I could not get it to do self sustaining traffic.



Linear Topology


% list any surprises / difficulties that you encountered (so that we can all learn from them)
\section{Discussion}  

The qualitative behavior of traffic models is difficult to understand. Some models seem to form shocks and rarefactions and others seem to not. It is difficult to tell whether this is due to the parameter setting or an inherent limitation in the model.

Aw Rascle model seems more aggressive. It is also nonlinear. Hence shocks?

Numerical Instability (preventing collisios but not updating velocities and accelerations to 0). Leads to NaN scores for sgd.

Need small deltas for sgd for small ks.

Need more clever penalty function, since cars can be | o o o o o o o o o           o o o | (good, but high penalty because of gap) or | o ooo o o ooo o oo o o o ooo oo  oo| (bad but good penalty becase of no gap)

How to handle infinite cost for SGD. For example, if we have a 1/avgvelocity term in the cost function and all the cars stop, the cost will be infinite. The cars will all stop in finite time if the active gains are set to zero.

Integrating the total cost over time might not be the best thing to do. What we want is the cost in the long run. Otherwise, systems that smooth out can often do far worse overall than systems that don't.

Key contribution of the approach: Control and verification of non-analytical systems.

\end{multicols}

\end{document}
